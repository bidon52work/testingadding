import logging
import os

logger = logging.getLogger(f"FPC.{__name__}")

PREFIX = '[Test Plugin]'
PLUGIN_FOLDER = f"storage/plugins/test-uuid-1234/"

def log(msg):
    logger.info(f"{PREFIX} {msg}")

NAME = "Test Plugin"
VERSION = "0.0.1"
DESCRIPTION = "–¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞–≥–∏–Ω –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏"
UUID = "324-2235-2342-1238"
SETTINGS_PAGE = False
CREDITS = "@tester"

def init_plugin(cardinal, *args):
    """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞–≥–∏–Ω"""
    log("–¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞–≥–∏–Ω –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è")
    # –°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫—É –¥–ª—è –ø–ª–∞–≥–∏–Ω–∞, –µ—Å–ª–∏ –µ–µ –Ω–µ—Ç
    if not os.path.exists(PLUGIN_FOLDER):
        os.makedirs(PLUGIN_FOLDER)
        log(f"–°–æ–∑–¥–∞–Ω–∞ –ø–∞–ø–∫–∞ –¥–ª—è –ø–ª–∞–≥–∏–Ω–∞: {PLUGIN_FOLDER}")
    
    # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –∫–æ–º–∞–Ω–¥—ã
    cardinal.add_telegram_commands(UUID, [
        ("testplugin", "üß™ –¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞–≥–∏–Ω", True)
    ])
    
    @cardinal.telegram.bot.message_handler(commands=["testplugin"])
    def test_cmd(m):
        m.bot.send_message(m.chat.id, "–¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞–≥–∏–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç!")
        log(f"–ö–æ–º–∞–Ω–¥–∞ testplugin –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –¥–ª—è —á–∞—Ç–∞ {m.chat.id}")
    
    log("–¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞–≥–∏–Ω —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")

log("–¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞–≥–∏–Ω –∑–∞–≥—Ä—É–∂–µ–Ω")

BIND_TO_PRE_INIT = [init_plugin]
BIND_TO_NEW_MESSAGE = []
BIND_TO_INIT = []
BIND_TO_DELETE = [] 
